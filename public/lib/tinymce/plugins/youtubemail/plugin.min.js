tinymce.PluginManager.add("youtubemail", function(editor, url) {
  // Add a button that opens a window
  editor.addButton("youtubemail", {
    text: "Youtubemail",
    icon: false,
    onclick: function() {
      // Open window
      editor.windowManager.open({
        title: "Youtubemail",
        body: [
          {type: "textbox", name: "youtubeLink", label: "Link"}
        ],
        onsubmit: function(e) {
          // extract video code, only handle standard format for now
          var video_id = e.data.youtubeLink.split('v=')[1];
          if (!video_id) {
              return alert("Couldn't get youtube ID. Try standard Youtube link?")
          }

          var video_imgsrc  = "https://img.youtube.com/vi/" + video_id + "/0.jpg";
          var ytube_logosrc = "http://www.iconarchive.com/download/i98467/dakirby309/simply-styled/YouTube.ico";

          // building HTMLcontent
          // var HTMLcontent = `
          //     <div id="frame" style="position: relative;display: inline-block">
          //       <img id="thumbnail" style="position: relative;z-index: 0" src="`+ video_imgsrc +`">
          //       <a href="`+ e.data.youtubeLink +`">
          //       <img id="overlay" style="width: 70px;position: absolute;top: 50%;left: 50%;transform: translate(-50%, -50%);" src="` + ytube_logosrc + `">
          //       </a>
          //     </div>
          // `;
          // var HTMLcontent = `
          //   <a href="` + e.data.youtubeLink + `">
          //     <img style="background: url('` + video_imgsrc + `') no-repeat center center;"
          //       src="http://www.iconarchive.com/download/i98467/dakirby309/simply-styled/YouTube.ico"
          //       width="480" height="360" border="1"/>
          //   </a>
          // `;
          // var HTMLcontent = `
          //   <a href="` + e.data.youtubeLink + `">
          //     <div style="width: 480px; height: 360px;background: url('` + video_imgsrc + `') no-repeat center center;">
          //       <img style="display: block;margin: auto;" src="http://www.iconarchive.com/download/i98467/dakirby309/simply-styled/YouTube.ico"/>
          //     </div>
          //   </a>
          // `;
          var HTMLcontent = `

              <a href="` + e.data.youtubeLink + `"style="display: block;width: 480px; height: 360px;background: url('` + video_imgsrc + `') no-repeat center center;">
                <img style="vertical-align: middle; display: block;"
                src="https://image.ibb.co/dhn2qo/youtube_logo_resized.png"/>
              </a>
          `;

          // Insert content when the window form is submitted
          editor.insertContent(HTMLcontent);
        }
      });
    }
  });
});
